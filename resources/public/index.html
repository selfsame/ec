<html><head>
  <link href="css/ce.css" type="text/css" rel="stylesheet">
  <script type="text/javascript" src="js/constants.js"></script>
  <script type="text/javascript" src="js/required.js"></script>
  <script type="text/javascript" src="main.js"></script>
  <script type="text/javascript" src='js/lib/three.min.js'></script>
  <script type="text/javascript" src='js/lib/Perlin.js'></script>
  <script type="text/javascript" src='js/lib/pathfinding.min.js'></script>
  <script type="text/javascript" src="js/components/standard.js"></script>
  <script type="text/javascript" src="js/components/three/standard.js"></script>
  <script type="text/javascript" src="js/components/joe.js"></script>
</head><body><script>

E.mandate(C.new.transform);

makeActor = function(name){
  return E(name,
    C.new.mesh({geometry: sphere, material: white}),
    C.new.scatter({x:5000,z:5000}),
    C.new.position_wrap({x:5000,z:5000}),
    C.new.wander({speed:Math.random()*20+5}))}

makeMapLayer = function(name, opts){
  return E(name,
    C.new.grid(),
    C.new.mesh({
      geometry:plane, material:ground, 
      y:-50, rotation:{x:-1.5708}}))}

function init(){
  actors = E("actors")
  for (var i=0;i<2000;i++){actors.add(makeActor("colonist"));}
  map = E("map",
    makeMapLayer("terrain", {o:32}),
    actors)

  root = E("game",
    C.new.loop(),
    C.new.camera(),
    C.new.scene(),
    C.new.renderer({w: window.innerWidth, h: window.innerHeight}),
    map)

    window.eventListen()
    E.mount(root)}

new THREE.TextureLoader().load(
  "assets/ground.png",
  function(tex){
    tex.wrapS = THREE.RepeatWrapping;
    tex.wrapT = THREE.RepeatWrapping;
    tex.repeat.set(20,20);
    ground = new THREE.MeshLambertMaterial({map:tex})
    init()})

</script></body></html>

